---
description: 麻雀の何切る問題を自動生成してMarkdownファイルとして保存する
---

今日の日付（YYYY-MM-DD形式）で新しい麻雀の何切る問題を生成してください。

## 要件

1. **問題の生成**
   - **難易度を設定**（1〜10の10段階）:
     - **1-2 (Very Easy)**: 明確な正解が1つのみ、計算不要、基本概念のみ
     - **3-4 (Easy)**: 基本的な分析で正解が明確、有力候補1-2個
       - 例: 現物があり危険牌も明確な押し引き問題
     - **5-6 (Medium)**: 複数要素の分析が必要、2-3個の合理的候補
     - **7-8 (Hard)**: 複雑な分析が必要、複数の有力候補とトレードオフ
     - **9-10 (Very Hard)**: エキスパート級の分析、候補間の微妙な違い
     - **難易度を決める要素**:
       - 正解の明確さ（明確=低難易度、微妙=高難易度）
       - 有力候補の数（少ない=低難易度、多い=高難易度）
       - 必要な分析の深さ（単純=低難易度、複雑=高難易度）
       - 候補間のトレードオフ（大きい差=低難易度、微妙な差=高難易度）
   - 問題のテーマを設定（例：リーチ判断、手役選択、押し引き、待ち選択、形式テンパイ、鳴き判断、安全牌選択など）
   - **手牌の作成（重要：向聴数を正しく認識すること）**:
     - テンパイ、イーシャンテン、リャンシャンテンなど、どの状態でも問題として有効
     - **重要**: 作成した手牌の向聴数を正確に把握し、問題文に正しく反映すること
     - 手牌作成の推奨手順：
       1. **完成形（14枚）から逆算**：和了形（4面子1雀頭）を作成
          - 例：🀈🀉🀊🀛🀜🀝🀔🀕🀖🀕🀕🀖🀗🀘
          - 分解：234m + 345p + 456s + 66s + 789s
       2. **向聴数に応じて調整**：
          - テンパイ問題：待ち牌を1枚抜く（例：🀖を抜いて🀖待ちのテンパイ）
          - イーシャンテン問題：面子を一部崩す
          - リャンシャンテン以上：さらに崩す
       3. **向聴数を計算して確認**：作成した13枚が何シャンテンか確認
       4. **問題文に正確に記載**：確認した向聴数を問題文に反映
          - 例：「現在テンパイ」「イーシャンテンの手牌」など
   - 局面の状態を設定（東1局、南2局など）
   - ドラ表示牌を設定
   - 自風・場風を設定
   - 河（捨て牌）の情報を含める
   - **点数状況の設定**:
     - テーマに応じて現在の点数・順位を明記
     - 押し引き問題では必須（例：「2位、トップと8000点差」）
     - リーチ判断や手役選択でも点数計算を考慮
     - 各プレイヤーの点数を記載（例：「自分25000点、下家32000点、対面18000点、上家25000点」）
     - オーラスや親番連荘など、特殊な状況も考慮

2. **問題の形式**
   問題は以下のMarkdown形式で `problems/NNN/question.md` に保存してください（NNNは連番、001, 002, ..., 999, 1000, ...）：

   ```markdown
   # 何切る問題 - YYYY年MM月DD日

   **難易度**: ★★★★★☆☆☆☆☆ (5/10)
   **テーマ**: [リーチ判断/手役選択/押し引き/待ち選択/形式テンパイ/鳴き判断/安全牌選択など]

   ## 局面情報
   - 場: 東1局/南2局など
   - 自風: 東/南/西/北
   - ドラ表示牌: 🀇
   - 巡目: X巡目

   ## あなたの手牌（13枚）
   ```
   🀇🀈🀉🀊🀋🀌🀍🀎🀏🀙🀚🀛🀜
   (1m2m3m4m5m6m7m8m9m1p2p3p4p)
   ```

   ## ツモ牌
   ```
   🀝
   (5p)
   ```
   **重要**:
   - ツモ牌を必ず明記すること。14枚（13枚+ツモ1枚）から何を切るかを問う形式にする。
   - **Unicode + 数字併記**を必ず行うこと（誤認防止のため）
   - 括弧内に数字表記を追加する形式で記載

   ## 河（捨て牌）
   **自分**: 🀀🀁🀂
   **下家**: 🀃🀄🀅
   **対面**: 🀆🀐🀑
   **上家**: 🀒🀓🀔

   ## 状況
   [必要に応じて追加の状況説明]

   ## 問題
   [テーマに応じた適切な問いかけを生成してください]

   例：
   - リーチ判断: 「この局面でリーチをかけますか？かけるなら何を切ってリーチしますか？それとも黙聴でしょうか？」
   - 手役選択: 「この手牌は何を目指すべきでしょうか？ホンイツ？チンイツ？それともタンヤオ？」
   - 押し引き: 「相手の手が進んでいるようですが、この局面で攻めますか？降りますか？」
   - 待ち選択: 「テンパイ時の待ちはどう選びますか？良形を取るべきか、ドラを残すべきか？」
   - 鳴き判断: 「この牌を鳴きますか？鳴くとしたら何を切りますか？鳴かない場合の打牌は？」
   - 安全牌選択: 「相手のリーチに対してどの牌を切りますか？最も安全な牌は？」
   ```

3. **牌の表記**
   - Unicode麻雀牌を使用（🀇-🀏 萬子、🀙-🀡 筒子、🀐-🀘 索子、🀀-🀆 字牌）
   - または数字表記（1m, 2p, 3s, 東, 南, 西, 北, 白, 發, 中）

4. **確認事項（必ず実施すること）**

   **手牌の妥当性チェック**:
   - ✅ **ツモ牌を必ず明記したか**（13枚+ツモ1枚=14枚の形式）
   - ✅ **Unicode + 数字併記を必ず行ったか**
     - 例: 🀇🀈🀙🀚🀛🀜🀔🀕🀖🀃🀃🀃🀅 の下に (1m2m1p2p3p4p5s6s7s北北北發) を記載
     - ツモ牌も同様に併記: 🀝 の下に (5p) を記載
   - ✅ ツモ牌なしでは「何を切るか」の問題は成立しないことを理解したか
   - ✅ 完成形（14枚）を先に作成し、4面子1雀頭が成立することを確認したか
   - ✅ 完成形から1枚抜いて13枚にしたか（テンパイ・イーシャンテンなどテーマに応じて）
   - ✅ 手牌が正確に13枚であることを確認（ツモ牌とは別）
   - ✅ **必ずUnicode麻雀牌の参照表（CLAUDE.md）を使って全ての牌を識別し、数字表記に変換**
     - Step 1: Unicode参照表で1枚ずつ確認
     - Step 2: 数字表記に変換（例: 🀔🀕🀖 → 5s6s7s）
     - Step 3: 順子を数字で確認（5-6-7は連続、4-5-6ではない）
     - 例：🀗は8s（七索ではない）、🀖は7s
     - 例：🀠は8p（九筒ではない）、🀡は9p
     - 例：🀎は8m（九萬ではない）、🀏は9m

   **向聴数の厳密な検証（重要！）**:
   - ✅ **手牌構成を数字表記で正確に把握する**:
     - 必ずUnicode → 数字変換を行う
     - 順子を数字で確認（例: 🀔🀕🀖 = 5s6s7s = 567s順子、NOT 456s!）
     - 5枚以上の連続牌は複数の解釈を検討:
       - 例: 1p2p3p4p5p = 123p順子 + 45p両面（最良）
       - OR: 234p順子 + 1p孤立 + 5p孤立
       - OR: 345p順子 + 12p辺張
   - ✅ **13枚の基本手牌の向聴数を計算**（ツモ前の状態）
   - ✅ **14枚全体（13枚+ツモ）の向聴数を計算**（問題文に記載する向聴数はこちら）
   - ✅ **有効牌を全てリストアップし、それぞれでどうなるかテスト**:
     - 例：「4pを引けばテンパイ」と書く場合
       1. 13枚の手牌に4pを加えて14枚にする
       2. 14枚の状態で1枚切ってテンパイになるか確認
       3. 他の牌（2p, 5p, 8pなど）でも同様にテストする
     - **重要**: 4種類以上の牌でテンパイに近づける手は、押し引き問題として不適切
   - ✅ **問題文の向聴数記述が正確か再確認**
     - 「イーシャンテン」と書くなら、本当にイーシャンテンか
     - 「テンパイ」と書くなら、本当にテンパイか
     - 実際にテンパイなのに「イーシャンテン」と書いていないか
   - ✅ **用語を正確に使用する**:
     - ❌ 誤り: "北のポン"（ポンは鳴いた刻子を指す）
     - ✅ 正解: "北の暗刻"（手牌の中の3枚）
     - ❌ 誤り: "456sの一盃口"（一盃口は同じ順子が2組）
     - ✅ 正解: "456sの順子"（単なる順子）
     - 一盃口の例: 234m + 234m（同じ順子が2組）

   **問題テーマと手牌の適合性チェック**:
   - ✅ **押し引き問題**の場合：
     - 手牌はイーシャンテン（有効牌2-3種類のみ）またはリャンシャンテン以上
     - 役は1-2翻程度（低打点）
     - **有効牌の正確な理解**:
       - 有効牌 = テンパイに直接向かう牌（例: 3m, 3p, 6p）
       - 孤立牌を切ることで雀頭形成の可能性が広がる場合、その孤立牌は有効牌ではない
       - 例: 14枚 1m2m1p2p3p4p5p5s6s7s北北北發（5pツモ後）の場合
         - 有効牌: 3m, 3p, 6p（テンパイに直接向かう）= 3種類
         - 發は有効牌ではなく切るべき孤立牌
         - 發を切ると1m,2m,1p,2p,4p,5pなどをツモって雀頭形成→テンパイ可能
     - 有効牌が4種類以上ある手は「攻めやすすぎる」ので不適切
     - **現物（げんぶつ）の設定**：ツモ牌や手牌にリーチ者の河に見える牌がある場合、それは**現物＝絶対安全牌**
   - ✅ **リーチ判断問題**の場合：
     - 手牌はテンパイしている
     - **CRITICAL: 4連形（1234, 2345, ..., 6789）をチェック**
       - 4連形がある場合、問題は**待ち選択問題**の要素を含む
       - 例: 2m3m4m 1p2p3p4p 6s7s8s 發發發 3p + ツモ1p
         - 選択肢: 3p切り（1p4pノベタン6枚）vs 1p切り（3p単騎2枚）
         - 主要判断：どの待ちを選ぶか、副次判断：リーチか黙聴か
     - 4連形がない場合、純粋なリーチ判断問題（リーチするか黙聴か）
   - ✅ **手作り・手役選択問題**の場合：
     - イーシャンテン〜リャンシャンテンが適切
   - ✅ **待ち選択問題**の場合：
     - テンパイまたはイーシャンテン
   - ✅ **安全牌選択問題**の場合：
     - リーチがかかっている状況で、手牌に現物や比較的安全な牌が複数ある

   **牌の枚数制限チェック**:
   - ✅ 麻雀では各牌は4枚までしか存在しない
   - ✅ 自分の手牌 + 全プレイヤーの河 + ドラ表示牌 + 鳴き牌で、同じ牌が5枚以上にならないこと
   - ✅ 例：🀇が自分の手牌に2枚、全員の河に合計2枚ある場合、残りは0枚（4枚全て見えている）

   **河の枚数と巡目の整合性チェック**:
   - ✅ 鳴きなしの場合：各プレイヤーの河の枚数は（巡目 - 1）枚が基本
   - ✅ 鳴きありの場合：鳴いたプレイヤーは河が減る（ポン/チーで3枚分、カンで4枚分）
   - ✅ リーチの場合：リーチ宣言した巡目までの河の枚数が妥当か確認
   - ✅ 例：11巡目なら各プレイヤーの河は基本10枚（鳴きがある場合は調整）

   **点数配分の妥当性チェック**:
   - ✅ 4人の合計点数が100000点であることを確認（標準ルール：配給原点25000点×4人）
   - ✅ **場と親の位置関係**を確認：
     - 東1局：東家が親
     - 東2局：南家が親
     - 東3局：西家が親
     - 東4局：北家が親
     - 南1局：東家が親、以降同様に順番が回る
   - ✅ **東1局0本場**：全員が必ず25000点（ゲーム開始直後、点数変動なし）
     - **制約**：点数配分を変えたい場合は、東1局0本場を使用してはいけない
     - **制約**：押し引き問題では東1局0本場を使用してはいけない（点数状況が重要なため）
   - ✅ **東1局1本場**：親（東家）が和了または親テンパイ流局の場合のみ発生
     - 親和了の場合：親の点数が25000点より増えているはず
     - 親テンパイ流局の場合：点数移動は小さい（±1000-3000点程度）
     - **注意**：親の点数が大幅に減っている（例：16000点）のは不自然
   - ✅ **東2局以降・南場**：大きな点数変動が自然（複数局が進行しているため）
   - ✅ **推奨**：シンプルな問題で点数状況が重要でない場合のみ「東1局0本場」で配給原点（25000×4）を使用
   - ✅ **推奨**：点数状況が重要な問題（押し引き、オーラスなど）は「東2局以降」「南場」「オーラス」を使用

   **ファイル保存の確認**:
   - ✅ ファイルが `problems/NNN/question.md` 形式で保存されることを確認（NNNは自動採番）

問題を生成した後、ファイルパスを出力してください。

**使用方法**:
- 引数なし: 次の番号で自動生成（例: `problems/001/question.md`）
- 引数あり: 指定した番号で生成（例: 引数に5を指定 → `problems/005/question.md`）
