---
description: 麻雀の何切る問題を自動生成してMarkdownファイルとして保存する
---

今日の日付（YYYY-MM-DD形式）で新しい麻雀の何切る問題を生成してください。

## 要件

1. **問題の生成**
   - ランダムな難易度（1〜10の10段階）を設定
   - 問題のテーマを設定（例：リーチ判断、手役選択、押し引き、待ち選択、形式テンパイ、鳴き判断、安全牌選択など）
   - **手牌の作成（重要：向聴数を正しく認識すること）**:
     - テンパイ、イーシャンテン、リャンシャンテンなど、どの状態でも問題として有効
     - **重要**: 作成した手牌の向聴数を正確に把握し、問題文に正しく反映すること
     - 手牌作成の推奨手順：
       1. **完成形（14枚）から逆算**：和了形（4面子1雀頭）を作成
          - 例：🀈🀉🀊🀛🀜🀝🀔🀕🀖🀕🀕🀖🀗🀘
          - 分解：234m + 345p + 456s + 66s + 789s
       2. **向聴数に応じて調整**：
          - テンパイ問題：待ち牌を1枚抜く（例：🀖を抜いて🀖待ちのテンパイ）
          - イーシャンテン問題：面子を一部崩す
          - リャンシャンテン以上：さらに崩す
       3. **向聴数を計算して確認**：作成した13枚が何シャンテンか確認
       4. **問題文に正確に記載**：確認した向聴数を問題文に反映
          - 例：「現在テンパイ」「イーシャンテンの手牌」など
   - 局面の状態を設定（東1局、南2局など）
   - ドラ表示牌を設定
   - 自風・場風を設定
   - 河（捨て牌）の情報を含める
   - **点数状況の設定**:
     - テーマに応じて現在の点数・順位を明記
     - 押し引き問題では必須（例：「2位、トップと8000点差」）
     - リーチ判断や手役選択でも点数計算を考慮
     - 各プレイヤーの点数を記載（例：「自分25000点、下家32000点、対面18000点、上家25000点」）
     - オーラスや親番連荘など、特殊な状況も考慮

2. **問題の形式**
   問題は以下のMarkdown形式で `problems/NNN/question.md` に保存してください（NNNは連番、001, 002, ..., 999, 1000, ...）：

   ```markdown
   # 何切る問題 - YYYY年MM月DD日

   **難易度**: ★★★★★☆☆☆☆☆ (5/10)
   **テーマ**: [リーチ判断/手役選択/押し引き/待ち選択/形式テンパイ/鳴き判断/安全牌選択など]

   ## 局面情報
   - 場: 東1局/南2局など
   - 自風: 東/南/西/北
   - ドラ表示牌: 🀇
   - 巡目: X巡目

   ## あなたの手牌
   ```
   🀇🀈🀉🀊🀋🀌🀍🀎🀏🀙🀚🀛🀜
   ```

   ## 河（捨て牌）
   **自分**: 🀀🀁🀂
   **下家**: 🀃🀄🀅
   **対面**: 🀆🀐🀑
   **上家**: 🀒🀓🀔

   ## 状況
   [必要に応じて追加の状況説明]

   ## 問題
   [テーマに応じた適切な問いかけを生成してください]

   例：
   - リーチ判断: 「この局面でリーチをかけますか？かけるなら何を切ってリーチしますか？それとも黙聴でしょうか？」
   - 手役選択: 「この手牌は何を目指すべきでしょうか？ホンイツ？チンイツ？それともタンヤオ？」
   - 押し引き: 「相手の手が進んでいるようですが、この局面で攻めますか？降りますか？」
   - 待ち選択: 「テンパイ時の待ちはどう選びますか？良形を取るべきか、ドラを残すべきか？」
   - 鳴き判断: 「この牌を鳴きますか？鳴くとしたら何を切りますか？鳴かない場合の打牌は？」
   - 安全牌選択: 「相手のリーチに対してどの牌を切りますか？最も安全な牌は？」
   ```

3. **牌の表記**
   - Unicode麻雀牌を使用（🀇-🀏 萬子、🀙-🀡 筒子、🀐-🀘 索子、🀀-🀆 字牌）
   - または数字表記（1m, 2p, 3s, 東, 南, 西, 北, 白, 發, 中）

4. **確認事項（必ず実施すること）**

   **手牌の妥当性チェック**:
   - ✅ 完成形（14枚）を先に作成し、4面子1雀頭が成立することを確認したか
   - ✅ 完成形から1枚抜いて13枚にしたか（テンパイ・イーシャンテンなどテーマに応じて）
   - ✅ 手牌が正確に13枚であることを確認
   - ✅ **必ずUnicode麻雀牌の参照表（CLAUDE.md）を使って全ての牌を識別**
     - 例：🀗は8s（七索ではない）、🀖は7s
     - 例：🀠は8p（九筒ではない）、🀡は9p
     - 例：🀎は8m（九萬ではない）、🀏は9m

   **向聴数の厳密な検証（重要！）**:
   - ✅ **13枚の基本手牌の向聴数を計算**（ツモ前の状態）
   - ✅ **有効牌を全てリストアップし、それぞれでどうなるかテスト**:
     - 例：「4pを引けばテンパイ」と書く場合
       1. 13枚の手牌に4pを加えて14枚にする
       2. 14枚の状態で1枚切ってテンパイになるか確認
       3. 他の牌（2p, 5p, 8pなど）でも同様にテストする
     - **重要**: 4種類以上の牌でテンパイに近づける手は、押し引き問題として不適切
   - ✅ **問題文の向聴数記述が正確か再確認**
     - 「イーシャンテン」と書くなら、本当にイーシャンテンか
     - 「テンパイ」と書くなら、本当にテンパイか
     - 実際にテンパイなのに「イーシャンテン」と書いていないか

   **問題テーマと手牌の適合性チェック**:
   - ✅ **押し引き問題**の場合：
     - 手牌はイーシャンテン（有効牌2-3種類のみ）またはリャンシャンテン以上
     - 役は1-2翻程度（低打点）
     - 有効牌が4種類以上ある手は「攻めやすすぎる」ので不適切
     - **現物（げんぶつ）の設定**：ツモ牌や手牌にリーチ者の河に見える牌がある場合、それは**現物＝絶対安全牌**
   - ✅ **リーチ判断問題**の場合：
     - 手牌はテンパイしている
   - ✅ **手作り・手役選択問題**の場合：
     - イーシャンテン〜リャンシャンテンが適切
   - ✅ **待ち選択問題**の場合：
     - テンパイまたはイーシャンテン
   - ✅ **安全牌選択問題**の場合：
     - リーチがかかっている状況で、手牌に現物や比較的安全な牌が複数ある

   **牌の枚数制限チェック**:
   - ✅ 麻雀では各牌は4枚までしか存在しない
   - ✅ 自分の手牌 + 全プレイヤーの河 + ドラ表示牌 + 鳴き牌で、同じ牌が5枚以上にならないこと
   - ✅ 例：🀇が自分の手牌に2枚、全員の河に合計2枚ある場合、残りは0枚（4枚全て見えている）

   **河の枚数と巡目の整合性チェック**:
   - ✅ 鳴きなしの場合：各プレイヤーの河の枚数は（巡目 - 1）枚が基本
   - ✅ 鳴きありの場合：鳴いたプレイヤーは河が減る（ポン/チーで3枚分、カンで4枚分）
   - ✅ リーチの場合：リーチ宣言した巡目までの河の枚数が妥当か確認
   - ✅ 例：11巡目なら各プレイヤーの河は基本10枚（鳴きがある場合は調整）

   **点数配分の妥当性チェック**:
   - ✅ 4人の合計点数が100000点であることを確認（標準ルール：配給原点25000点×4人）
   - ✅ **場と親の位置関係**を確認：
     - 東1局：東家が親
     - 東2局：南家が親
     - 東3局：西家が親
     - 東4局：北家が親
     - 南1局：東家が親、以降同様に順番が回る
   - ✅ **東1局0本場**：全員が必ず25000点（ゲーム開始直後、点数変動なし）
     - **制約**：点数配分を変えたい場合は、東1局0本場を使用してはいけない
     - **制約**：押し引き問題では東1局0本場を使用してはいけない（点数状況が重要なため）
   - ✅ **東1局1本場**：親（東家）が和了または親テンパイ流局の場合のみ発生
     - 親和了の場合：親の点数が25000点より増えているはず
     - 親テンパイ流局の場合：点数移動は小さい（±1000-3000点程度）
     - **注意**：親の点数が大幅に減っている（例：16000点）のは不自然
   - ✅ **東2局以降・南場**：大きな点数変動が自然（複数局が進行しているため）
   - ✅ **推奨**：シンプルな問題で点数状況が重要でない場合のみ「東1局0本場」で配給原点（25000×4）を使用
   - ✅ **推奨**：点数状況が重要な問題（押し引き、オーラスなど）は「東2局以降」「南場」「オーラス」を使用

   **ファイル保存の確認**:
   - ✅ ファイルが `problems/NNN/question.md` 形式で保存されることを確認（NNNは自動採番）

問題を生成した後、ファイルパスを出力してください。

**使用方法**:
- 引数なし: 次の番号で自動生成（例: `problems/001/question.md`）
- 引数あり: 指定した番号で生成（例: 引数に5を指定 → `problems/005/question.md`）
