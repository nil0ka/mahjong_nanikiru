---
description: 既存の何切る問題に対する回答と解説を生成してMarkdownファイルとして保存する
---

既存の問題ファイル `problems/NNN/question.md` を読み込み、その問題に対する回答と解説を生成してください。

## 要件

1. **問題ファイルの読み込み**
   - `problems/NNN/question.md` を読み込む（NNNは指定または最新の問題番号）
   - 問題が存在しない場合はエラーを出力

2. **回答の生成**
   - **重要な分析手順**:
     1. **Unicode牌の正確な識別**: CLAUDE.mdの参照表を使って牌を正確に識別
        - 特に🀠（8p）と🀡（9p）、🀎（8m）と🀏（9m）などを混同しないこと
     2. **手牌の向聴数を計算**: 問題文を鵜呑みにせず、実際に計算して確認
        - **3つのパターンを検討**:
          - 標準形（4面子1雀頭）
          - 七対子（7つの対子）- 2翻固定、常に25符
          - 国士無双（13種の么九牌）- 役満
        - 例：標準形ではイーシャンテンだが、七対子ではテンパイというケースもある
        - 一盃口から七対子への変化なども考慮
        - 問題文の記述と実際の計算が異なる場合は、実際の計算結果を優先
     3. **見えている牌の集計**: 手牌、全河、ドラ表示牌から各牌の残り枚数を計算
     4. **推奨打牌の妥当性確認**: 推奨する打牌が手牌に実際に含まれているか確認
   - 問題の問いかけを正確に理解する
   - 問いかけに対する明確な回答を提示
   - 最適な打牌や判断を決定
   - その理由を詳しく解説

3. **回答の形式**
   回答は以下のMarkdown形式で `problems/NNN/solution.md` に保存してください（NNNは連番、001, 002, ..., 999, 1000, ...）：

   ```markdown
   # 何切る問題の回答 - YYYY年MM月DD日

   ## 問題の再掲
   [元の問題から手牌と状況、問いかけを引用]

   ## 回答
   [問題の問いかけに対応した回答を記述]

   例：
   - 「リーチをかけますか？」→「はい、🀇を切ってリーチをかけるべきです。」
   - 「攻めますか？降りますか？」→「この局面では降りるべきです。🀆を切って安全牌を確保しましょう。」
   - 「どの牌を鳴きますか？」→「鳴かずに🀈を切るのが最善です。」

   ## 解説

   ### 手牌の分析
   - 現在の形: [テンパイ/1シャンテン/2シャンテンなど]
   - 有効牌: [何を引けば良い形になるか]

   ### 各候補の検討

   **重要：候補は必ず良い順（リスクの低い順）に並べる**
   - 候補1：最善の選択（推奨する打牌）
   - 候補2：次善の選択
   - 候補3：最悪の選択（明確にラベル付けする）

   #### 候補1: 🀇を切った場合 - 最善の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: X枚

   #### 候補2: 🀈を切った場合 - 次善の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: Y枚

   #### 候補3: 🀉を切った場合 - 最悪の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: Z枚
   - 結論: 3つの候補の中で最も危険/最悪

   ### 結論
   [なぜこの牌を切るべきかの総括]

   ## 別解・補足
   [状況によっては他の選択肢もありうる場合の説明]

   ## 学習ポイント
   - [この問題から学べる麻雀の考え方や技術]
   ```

4. **解説の品質**
   - 初心者にも分かりやすい説明を心がける
   - 複数の候補がある場合はそれぞれを比較
   - 受け入れ枚数や期待値などの定量的な情報も含める
   - 難易度に応じて解説の詳しさを調整
   - **点数計算を明示**:
     - 手牌の役を正確に認識（リーチ、タンヤオ、ピンフ、役牌など）
     - ドラの枚数を数えて翻数を計算
     - 符計算も行い、何翻何符で何点になるか明記
     - **標準形の例**:
       - 例1：「リーチ1翻＋タンヤオ1翻＋ドラ2翻=4翻30符で7700点（ロン）」
       - 例2：「リーチ1翻＋ツモ1翻＋ピンフ1翻＋ドラ1翻=4翻20符で2600オール（親ツモ）または1300-2600（子ツモ）」
       - 例3：「リーチ1翻＋ツモ1翻＋ピンフ1翻＋ドラ2翻=5翻20符で満貫8000点」
       - 例4：「役牌1翻＋ドラ3翻=4翻40符で満貫8000点」
     - **七対子の例**:
       - 例5：「七対子2翻＋ドラ2翻=4翻25符で6400点（常に25符固定）」
       - 例6：「七対子2翻＋ドラ3翻=5翻25符で満貫8000点」
     - **食い下がり（鳴いた場合の翻数減少）**:
       - タンヤオ1翻（鳴き可）＋ドラ3翻=4翻30符で7700点
       - ホンイツ3翻→鳴くと2翻、チンイツ6翻→鳴くと5翻
       - 三色2翻→鳴くと1翻、一気通貫2翻→鳴くと1翻
       - リーチ、ピンフ、ツモ、一盃口、七対子、国士無双は鳴けない
     - 重要：4翻は符によって異なる（20符=2600オール/1300-2600、25符=6400点、30符=7700点、40符以上=8000点満貫）
     - 注意：4翻20符は5翻に切り上げられない
     - 親/子の違いを考慮（親は1.5倍、ツモの場合は支払い方も異なる）
   - **押し引き判断における期待値分析**（押し引きテーマの問題では必須）:

     **自分の手の分析**:
     - ✅ **理想形のパターンを全て列挙**（役と点数を明記）:
       - 最低ライン：基本役のみ（例：「發のみ1翻=1000-2000点」）
       - リーチ込み：リーチ＋基本役（例：「リーチ1翻＋發1翻=2翻=2000-3900点」）
       - ドラ込み：ドラを含む（例：「リーチ1翻＋發1翻＋ドラ1翻=3翻=3900-5800点」）
       - 最良ケース：（例：「リーチ1翻＋ツモ1翻＋發1翻＋ドラ2翻=5翻=満貫8000点」）
     - ✅ **現実的な評価**：向聴数、有効牌枚数、巡目を考慮して「極めて低い」「低い」「中程度」「高い」で評価
     - ❌ **禁止事項**：「5-10%の和了確率」「35%の放銃率」などの根拠のない確率数値を使わないこと

     **相手の手の分析**（特にリーチ者）:
     - ✅ **河の情報を詳細に分析**:
       - ドラの可視性：「ドラ2s（🀑）が見えていない→ドラ1枚以上の可能性が高い」
       - 役牌の可視性：「東南中は切られているが、白發北は見えていない→役牌の可能性あり」
       - 染め手の可能性：「萬筒索が混在→ホンイツ・チンイツではない」
       - リーチタイミング：「8巡目の早いリーチ→良形待ちの可能性が高い」
     - ✅ **想定される手役パターンを複数列挙**（点数範囲を明記）:
       - パターン1：リーチのみ=1000-2000点（ドラが見えていない場合は「可能性は低い」と明記）
       - パターン2：リーチ＋ツモ=2翻=2000-3900点
       - パターン3：リーチ＋ドラ1=2翻=2000-3900点
       - パターン4：リーチ＋役牌=2翻=2000-3900点
       - パターン5：リーチ＋ドラ1＋ツモ=3翻=3900-5800点
       - パターン6：リーチ＋ドラ2以上=3翻以上=3900-8000点以上
       - パターン7：リーチ＋ピンフ＋ドラ＋ツモ=4翻=満貫8000点
     - ✅ **結論として最も可能性の高い点数範囲を明記**:
       - 例：「ドラが見えていないため、3翻（3900-5800点）以上の可能性が高い。最低でも2翻2000点以上、最悪満貫8000点の可能性もある。」
       - 例：「放銃時の損失：2000-8000点規模（現実的には3000-6000点程度）」
     - ❌ **禁止事項**：「4000点×35%=1400点の期待損失」のような単一点数推測を使わないこと

     **最終的な比較**:
     - ✅ **定性的な比較を使用**：
       - 例：「和了期待値（極めて低い、仮に和了しても1000-2000点）<< 放銃時の損失（3000-6000点規模）」
     - ❌ **禁止事項**：明確な根拠なく数値化した期待値を使わないこと

     **重要な原則**:
     - 順位と点差を考慮した最適判断を提示
     - 河の情報を必ず活用して相手の手を推測
     - 理想形を明示することで、押すべきか否かの判断根拠を明確にする

5. **確認事項（必ず実施すること）**

   **手牌認識の正確性**:
   - ✅ **必ずUnicode牌参照表（CLAUDE.md）を使って全ての牌を識別**
     - 例：🀗は8s（七索ではない）、🀖は7s
     - 例：🀠は8p（九筒ではない）、🀡は9p
     - 例：🀎は8m（九萬ではない）、🀏は9m
   - ✅ 手牌13枚を正しく読み取れているか（1枚ずつ参照表で確認）
   - ✅ 推奨打牌が実際に手牌に含まれているか確認したか

   **向聴数計算の正確性**:
   - ✅ 手牌の向聴数を実際に計算したか（問題文を鵜呑みにしない）
   - ✅ **有効牌を全てリストアップし、それぞれでどうなるかテスト**:
     - 例：問題文が「4pを引けばテンパイ」と書いている場合
       1. 実際に4pを加えて14枚にする
       2. 14枚の状態で1枚切ってテンパイになるか確認
       3. 他の牌（2p, 5p, 8pなど）でも同様にテストする
     - 問題文に書かれていない有効牌も発見して解説に含める
   - ✅ 解説で「テンパイ」と書くなら、実際にテンパイか確認したか
   - ✅ 問題文の記述と実際の計算が異なる場合、実際の計算結果を優先したか
   - ✅ 問題文に向聴数の誤りがある場合、解説中で指摘する

   **牌の枚数計算の正確性**:
   - ✅ 見えている牌を正確に集計したか（手牌 + 全河 + ドラ表示牌 + 鳴き牌）
   - ✅ 各牌の残り枚数を正しく計算したか（各牌は4枚まで）
   - ✅ 待ち牌の残り枚数を計算したか（河に見えている分を除外）
   - ✅ 受け入れ枚数の計算が正確か（見えている牌を考慮）
   - ✅ アウト牌（危険牌）の枚数計算が正しいか

   **現物（げんぶつ）の識別**:
   - ✅ **押し引き・安全牌選択問題では必須**：リーチがかかっている場合、現物を正確に識別したか
   - ✅ **現物の定義**：リーチ者が既に捨てた牌 = 絶対に当たらない = 100%安全
   - ✅ **識別方法**：リーチ者の河（捨て牌）を確認し、手牌やツモ牌と照合
   - ✅ **記述の正確性**：
     - ❌ 誤り：「対面の河に見えているので比較的安全」
     - ✅ 正解：「対面（リーチ者）の河に見えている現物なので絶対安全（100%安全、0%リスク）」
   - ✅ **複数リーチの場合**：どのリーチ者に対する現物かを明確にする
   - ✅ **重要**：現物があれば必ず「現物 = 絶対安全」と明記し、「比較的安全」などの曖昧な表現は使わない

   **点数計算の正確性**:
   - ✅ 役を正確に認識したか（リーチ、タンヤオ、ピンフなど）
   - ✅ ドラの枚数を正しく数えたか
   - ✅ 翻数と点数の対応が正しいか（1-2翻、3翻、4-5翻満貫、6-7翻跳満など）
   - ✅ 親/子の違いを考慮したか

   **押し引き判断の分析の正確性**（押し引き問題の場合）:
   - ✅ **自分の手の理想形を全て列挙したか**（最低ライン～最良ケースまで）
   - ✅ **和了期待値を定性的に評価したか**（「極めて低い」「低い」「中程度」「高い」）
   - ✅ **相手の河を詳細に分析したか**（ドラの可視性、役牌の可視性、染め手の可能性、リーチタイミング）
   - ✅ **相手の想定手役パターンを複数列挙したか**（7パターン程度、点数範囲付き）
   - ✅ **相手の手の最も可能性の高い点数範囲を結論として明記したか**
   - ✅ **定性的な比較で押し引き判断を示したか**（例：「和了期待値 << 放銃損失」）
   - ❌ **禁止：根拠のない確率数値を使っていないか**（「5-10%」「35%」など）
   - ❌ **禁止：単一点数推測を使っていないか**（「4000点×35%=1400点」など）

   **候補の順序の正確性**:
   - ✅ **候補を必ず良い順（リスクの低い順）に並べたか**
     - 候補1：最善の選択（推奨）
     - 候補2：次善の選択
     - 候補3：最悪の選択
   - ✅ **最悪の候補に明確なラベルを付けたか**（例：「3つの候補の中で最も危険」）
   - ❌ **禁止：候補2が最悪で候補3が次悪という逆順になっていないか**

   **点数配分の妥当性確認**:
   - ✅ 4人の点数合計が100000点になっているか確認
   - ✅ **東1局0本場**の場合：全員が25000点であることを確認
     - 点数に変動があれば問題設定の誤りを指摘
   - ✅ **東1局1本場**の場合：親の点数変動が妥当か確認
     - 親和了 → 親の点数が増えているはず（25000点以上）
     - 親テンパイ流局 → 点数変動は小さい（±1000-3000点程度）
     - 親の点数が大幅減少（例：16000点）は不自然 → 問題設定の誤りを指摘
   - ✅ 問題文の局・本場設定と点数配分が矛盾している場合：
     - 解説中でその矛盾を指摘する
     - ただし、解答自体は問題文の設定を前提として書く

   **ファイル保存の確認**:
   - ✅ ファイルが `problems/NNN/solution.md` 形式で保存されることを確認
   - ✅ 解説が論理的で分かりやすいことを確認

回答を生成した後、ファイルパスを出力してください。

**使用方法**:
- 引数なし: 最新の問題に対する回答を生成（例: `problems/003/solution.md`）
- 引数あり: 指定した番号の問題に対する回答を生成（例: 引数に1を指定 → `problems/001/solution.md`）
