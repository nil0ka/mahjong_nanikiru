---
description: 既存の何切る問題に対する回答と解説を生成してMarkdownファイルとして保存する
---

既存の問題ファイル `problems/NNN/question.md` を読み込み、その問題に対する回答と解説を生成してください。

## 要件

1. **問題ファイルの読み込み**
   - `problems/NNN/question.md` を読み込む（NNNは指定または最新の問題番号）
   - 問題が存在しない場合はエラーを出力

2. **回答の生成**
   - **重要な分析手順**:
     1. **Unicode牌の正確な識別**: CLAUDE.mdの参照表を使って牌を正確に識別
        - 特に🀠（8p）と🀡（9p）、🀎（8m）と🀏（9m）などを混同しないこと
     2. **手牌の向聴数を計算**: 問題文を鵜呑みにせず、実際に計算して確認
        - **3つのパターンを検討**:
          - 標準形（4面子1雀頭）
          - 七対子（7つの対子）- 2翻固定、常に25符
          - 国士無双（13種の么九牌）- 役満
        - 例：標準形ではイーシャンテンだが、七対子ではテンパイというケースもある
        - 一盃口から七対子への変化なども考慮
        - 問題文の記述と実際の計算が異なる場合は、実際の計算結果を優先
     3. **見えている牌の集計**: 手牌、全河、ドラ表示牌から各牌の残り枚数を計算
     4. **テンパイ時の待ち選択チェック**（テンパイ・リーチ判断問題の場合）:
        - **4連形（1234, 2345, ..., 6789）の存在を必ず確認**
        - 4連形がある場合、ノベタン（延べ単・両端待ち）の可能性を必ず検討
        - 例: 1234p → 1p待ち（11p+234p）または4p待ち（123p+44p）のノベタン
        - **全ての待ち選択肢をリストアップ**（13枚のテンパイ形に固執しない）
        - 各待ちの受け入れ枚数を計算し、明示的に比較（「X枚 vs Y枚 = Z倍」）
     5. **推奨打牌の妥当性確認**: 推奨する打牌が手牌に実際に含まれているか確認
   - 問題の問いかけを正確に理解する
   - 問いかけに対する明確な回答を提示
   - 最適な打牌や判断を決定
   - その理由を詳しく解説

3. **回答の形式**
   回答は以下のMarkdown形式で `problems/NNN/solution.md` に保存してください（NNNは連番、001, 002, ..., 999, 1000, ...）：

   ```markdown
   # 何切る問題の回答 - YYYY年MM月DD日

   ## 問題の再掲
   [元の問題から手牌と状況、問いかけを引用]

   ## 回答
   [問題の問いかけに対応した回答を記述]

   例：
   - 「リーチをかけますか？」→「はい、🀇を切ってリーチをかけるべきです。」
   - 「攻めますか？降りますか？」→「この局面では降りるべきです。🀆を切って安全牌を確保しましょう。」
   - 「どの牌を鳴きますか？」→「鳴かずに🀈を切るのが最善です。」

   ## 解説

   ### 手牌の分析

   **重要**: 解説では必ずUnicode + 数字併記で手牌を記載すること

   例:
   ```
   **14枚の手牌**:
   - 🀇 (1m)、🀈 (2m)
   - 🀙 (1p)、🀚 (2p)、🀛 (3p)、🀜 (4p)、🀝 (5p)
   - 🀔 (5s)、🀕 (6s)、🀖 (7s)
   - 🀃 (北) × 3枚
   - 🀅 (發) × 1枚
   ```

   または:
   ```
   手牌14枚: 🀇🀈🀙🀚🀛🀜🀝🀔🀕🀖🀃🀃🀃🀅
   数字表記: 1m2m1p2p3p4p5p5s6s7s北北北發
   ```

   - 現在の形: [テンパイ/1シャンテン/2シャンテンなど]
   - 有効牌: [何を引けば良い形になるか]

   ### 各候補の検討

   **候補の整理方法（2つのアプローチ）**:

   **アプローチA: 戦略別分類（押し引き問題で推奨）**:
   - 3つの戦略（様子見、完全降り、全力攻め）に基づいて候補を分類
   - 最善の戦略（通常は様子見）を候補1とする
   - 例（押し引き問題、現物あり）:
     - 候補1: 發を切る - **様子見戦略（最善）** - 現物で安全、手の進行可能性を残す
     - 候補2: 5pを切る - **完全降り戦略** - 現物だが有効牌を切る（極端な状況でのみ）
     - 候補3: 1pを切る - **攻める戦略（最悪）** - 現物でなくリスク高い、この状況では不適切

   **アプローチB: リスク順分類（その他の問題タイプで有効）**:
   - 候補1：最善の選択（推奨する打牌）
   - 候補2：次善の選択
   - 候補3：最悪の選択（明確にラベル付けする）

   **押し引き問題の候補例（戦略別）**:

   #### 候補1: 🀅（發）を切る - 様子見戦略（最善）
   - **戦略**: 様子見（安全牌を切りつつ柔軟性を保つ）
   - メリット:
     - 現物（絶対安全、100%安全）
     - 孤立牌で手の進行に影響少ない
     - 次巡で有効牌（3mなど）を引けば攻めに転じられる
   - デメリット: なし
   - 結論: **この状況での最善手。安全を確保しつつ和了可能性も残す。**

   #### 候補2: 🀙（1p）を切る - 攻める戦略（不適切）
   - **戦略**: 攻める（危険牌でも手を進める）
   - メリット: 端牌で比較的安全（対面の河に1枚見える）
   - デメリット:
     - **現物ではない** → 放銃リスクあり
     - 筒子中心の相手に対して筒子を切るのは危険
   - 結論: 現物（發）がある以上、わざわざリスクを取る必要はない。

   #### 候補3: 🀞（6p）を切る - 攻める戦略（最悪）
   - **戦略**: 攻める（手を進める牌を切る）
   - メリット: 手牌整理にはなる
   - デメリット:
     - **相手は筒子を1枚も切っていない** → 筒子待ちの可能性極めて高い
     - 放銃リスク: 極めて高い
   - 結論: **3つの候補の中で最も危険。絶対に避けるべき。**

   **その他の問題タイプの候補例（リスク順）**:

   #### 候補1: 🀇を切った場合 - 最善の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: X枚

   #### 候補2: 🀈を切った場合 - 次善の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: Y枚

   #### 候補3: 🀉を切った場合 - 最悪の選択
   - メリット: [...]
   - デメリット: [...]
   - 受け入れ枚数: Z枚
   - 結論: 3つの候補の中で最も不適切

   ### 結論
   [なぜこの牌を切るべきかの総括]

   ## 別解・補足
   [状況によっては他の選択肢もありうる場合の説明]

   ## 学習ポイント
   - [この問題から学べる麻雀の考え方や技術]
   ```

4. **解説の品質**
   - 初心者にも分かりやすい説明を心がける
   - 複数の候補がある場合はそれぞれを比較
   - 受け入れ枚数や期待値などの定量的な情報も含める
   - 難易度に応じて解説の詳しさを調整
   - **点数計算を明示**:
     - 手牌の役を正確に認識（リーチ、タンヤオ、ピンフ、役牌など）
     - ドラの枚数を数えて翻数を計算
     - 符計算も行い、何翻何符で何点になるか明記
     - **標準形の例**:
       - 例1：「リーチ1翻＋タンヤオ1翻＋ドラ2翻=4翻30符で7700点（ロン）」
       - 例2：「リーチ1翻＋ツモ1翻＋ピンフ1翻＋ドラ1翻=4翻20符で2600オール（親ツモ）または1300-2600（子ツモ）」
       - 例3：「リーチ1翻＋ツモ1翻＋ピンフ1翻＋ドラ2翻=5翻20符で満貫8000点」
       - 例4：「役牌1翻＋ドラ3翻=4翻40符で満貫8000点」
     - **七対子の例**:
       - 例5：「七対子2翻＋ドラ2翻=4翻25符で6400点（常に25符固定）」
       - 例6：「七対子2翻＋ドラ3翻=5翻25符で満貫8000点」
     - **食い下がり（鳴いた場合の翻数減少）**:
       - タンヤオ1翻（鳴き可）＋ドラ3翻=4翻30符で7700点
       - ホンイツ3翻→鳴くと2翻、チンイツ6翻→鳴くと5翻
       - 三色2翻→鳴くと1翻、一気通貫2翻→鳴くと1翻
       - リーチ、ピンフ、ツモ、一盃口、七対子、国士無双は鳴けない
     - 重要：4翻は符によって異なる（20符=2600オール/1300-2600、25符=6400点、30符=7700点、40符以上=8000点満貫）
     - 注意：4翻20符は5翻に切り上げられない
     - 親/子の違いを考慮（親は1.5倍、ツモの場合は支払い方も異なる）
   - **押し引き判断における期待値分析**（押し引きテーマの問題では必須）:

     **CRITICAL: 押し引きの3つの戦略 - 様子見がデフォルト**

     押し引き問題では、単純な「攻める/降りる」の二択ではなく、3つの選択肢を検討すべき：

     **重要: 様子見（中間戦略）が最も一般的なデフォルト戦略。完全降りと全力攻めは極端な状況でのみ使用。**

     1. **様子見（中間戦略）** ← **デフォルト戦略（最も一般的）**:
        - **比較的安全な牌を切りつつ手を進める可能性を残す**
        - **これは「降りる」ではなく「柔軟性を保つ」戦略**
        - リスク: 低〜中、リターン: 手が進めば攻めに転じる可能性
        - **適用場面（ほとんどの押し引き問題）**:
          - 現物や安全牌がある
          - イーシャンテンで有効牌が残っている
          - 非クリティカルな順位・点数状況（例: 2位、中程度の点差）
          - 相手リーチだが絶望的な状況ではない
          - 巡目8-12（中盤）でまだ手に可能性がある
        - **比較的安全な牌**:
          - 孤立字牌（特に役牌でない場合や1枚のみの役牌）
          - 現物（リーチ者の河に見える牌）← 最も安全
          - 早巡に切られた牌の筋
          - 端牌（1,9）で河に見えている同種の牌が多い
        - **様子見の例1**: 14枚 1m2m1p2p3p4p5p5s6s7s北北北發（親番1位、対面リーチ中）
          - 打發: 現物（安全）、孤立牌
          - 有効牌（3m, 2p, 3p, 6p）での進行可能性を残す
          - 發を切ることで多くの牌で雀頭形成→テンパイ可能
          - **これは完全降りではない**: 次巡で3mを引けば攻めに転じる柔軟性
        - **様子見の例2**: 14枚 1m2m1p3p4p5p6p5s6s7s北北北發（2位、5000点差、11巡目、上家リーチ）
          - 打發: 現物（絶対安全）、孤立牌
          - イーシャンテンで有効牌（3m, 2pなど）あり
          - **完全降りではない**: 次巡で手が進めば攻めに転じる選択肢を残す
        - **戦略フロー**:
          1. 今巡は安全牌（現物または比較的安全な牌）を切る
          2. 次のツモを観察
          3. 有効牌を引いた → 攻めに転じることを検討
          4. 状況悪化または手が進まない → 様子見継続または完全降りへ移行
        - **重要**: 様子見は「柔軟性を維持」する戦略であり、和了可能性を放棄していない

     2. **完全に降りる（ベタ降り）** ← **極端な状況でのみ使用（稀）**:
        - 複数巡にわたり現物のみを切り続けて流局を目指す
        - **明示的に全ての和了可能性を放棄**
        - リスク: 0%、リターン: 和了可能性を完全放棄
        - **様子見との違い**: 今後の全巡で現物のみ切り、どんな牌を引いても攻めない
        - **適用場面（極端な状況のみ）**:
          - オーラス（南4局）でクリティカルな順位（例: 2位だが3位と僅差）
          - 大差がついて逆転不可能（例: 1位と20000点差）
          - 手が3シャンテン以上で和了の見込みが全くない
          - 複数の現物があり残り巡目を全て現物で切れる
          - **AND** 順位を守ることが絶対優先
        - **重要**: イーシャンテンで有効牌がある場合は完全降りではなく「様子見」を使う

     3. **全力で攻める** ← **勝負をかける状況でのみ使用（稀）**:
        - 危険牌でも手を進める牌を切る
        - リスク: 高、リターン: 和了可能性最大化
        - **適用場面（極端な状況のみ）**:
          - オーラスで和了しないと順位が上がらない（例: 4位、大きな和了が必要）
          - テンパイまたは良いイーシャンテンで高打点の可能性
          - 点差が大きく、和了でしか逆転できない
        - **重要**: 通常の押し引き問題（2位、中程度の差）では使わない

     **デフォルト判断フロー**:
     1. 現物や安全牌がある？ → Yes
     2. イーシャンテン以下で有効牌あり？ → Yes
     3. 順位・点数状況が非クリティカル？ → Yes
     4. **→ デフォルト: 様子見戦略を使用**
     5. 完全降りを使うのは: オーラス + クリティカル順位 + 3シャンテン以上 + 複数現物ある場合のみ
     6. 全力攻めを使うのは: 和了しないと順位が上がらない + 良い手 の場合のみ

     **自分の手の分析**:
     - ✅ **理想形のパターンを全て列挙**（役と点数を明記）:
       - 最低ライン：基本役のみ（例：「發のみ1翻=1000-2000点」）
       - リーチ込み：リーチ＋基本役（例：「リーチ1翻＋發1翻=2翻=2000-3900点」）
       - ドラ込み：ドラを含む（例：「リーチ1翻＋發1翻＋ドラ1翻=3翻=3900-5800点」）
       - 最良ケース：（例：「リーチ1翻＋ツモ1翻＋發1翻＋ドラ2翻=5翻=満貫8000点」）
     - ✅ **現実的な評価**：向聴数、有効牌枚数、巡目を考慮して「極めて低い」「低い」「中程度」「高い」で評価
     - ❌ **禁止事項**：「5-10%の和了確率」「35%の放銃率」などの根拠のない確率数値を使わないこと

     **相手の手の分析**（特にリーチ者）:
     - ✅ **河の情報を詳細に分析**:
       - ドラの可視性：「ドラ2s（🀑）が見えていない→ドラ1枚以上の可能性が高い」
       - 役牌の可視性：「東南中は切られているが、白發北は見えていない→役牌の可能性あり」
       - 染め手の可能性：「萬筒索が混在→ホンイツ・チンイツではない」
       - リーチタイミング：「8巡目の早いリーチ→良形待ちの可能性が高い」
     - ✅ **想定される手役パターンを複数列挙**（点数範囲を明記）:
       - パターン1：リーチのみ=1000-2000点（ドラが見えていない場合は「可能性は低い」と明記）
       - パターン2：リーチ＋ツモ=2翻=2000-3900点
       - パターン3：リーチ＋ドラ1=2翻=2000-3900点
       - パターン4：リーチ＋役牌=2翻=2000-3900点
       - パターン5：リーチ＋ドラ1＋ツモ=3翻=3900-5800点
       - パターン6：リーチ＋ドラ2以上=3翻以上=3900-8000点以上
       - パターン7：リーチ＋ピンフ＋ドラ＋ツモ=4翻=満貫8000点
     - ✅ **結論として最も可能性の高い点数範囲を明記**:
       - 例：「ドラが見えていないため、3翻（3900-5800点）以上の可能性が高い。最低でも2翻2000点以上、最悪満貫8000点の可能性もある。」
       - 例：「放銃時の損失：2000-8000点規模（現実的には3000-6000点程度）」
     - ❌ **禁止事項**：「4000点×35%=1400点の期待損失」のような単一点数推測を使わないこと

     **最終的な比較**:
     - ✅ **定性的な比較を使用**：
       - 例：「和了期待値（極めて低い、仮に和了しても1000-2000点）<< 放銃時の損失（3000-6000点規模）」
     - ❌ **禁止事項**：明確な根拠なく数値化した期待値を使わないこと

     **重要な原則**:
     - 順位と点差を考慮した最適判断を提示
     - 河の情報を必ず活用して相手の手を推測
     - 理想形を明示することで、押すべきか否かの判断根拠を明確にする

5. **確認事項（必ず実施すること）**

   **手牌認識の正確性**:
   - ✅ **ツモ牌が問題文に明記されているか確認**
     - ツモ牌がない場合：問題の誤りを指摘し、解答は「ツモ牌によって判断が変わる可能性がある」旨を記載
   - ✅ **必ずUnicode牌参照表（CLAUDE.md）を使って全ての牌を識別し、数字表記に変換**
     - **MANDATORY PROCESS**:
       1. Unicode参照表で1枚ずつ確認
       2. 数字表記に変換（例: 🀔🀕🀖 → 5s6s7s）
       3. 数字で順子を確認（5-6-7は連続、4-5-6ではない）
     - 例：🀗は8s（七索ではない）、🀖は7s
     - 例：🀠は8p（九筒ではない）、🀡は9p
     - 例：🀎は8m（九萬ではない）、🀏は9m
   - ✅ **解答文で必ずUnicode + 数字併記を行う**
     - 例: 手牌14枚: 🀇🀈🀙🀚🀛🀜🀝🀔🀕🀖🀃🀃🀃🀅
     - 数字表記: 1m2m1p2p3p4p5p5s6s7s北北北發
   - ✅ 手牌13枚を正しく読み取れているか（1枚ずつ参照表で確認）
   - ✅ ツモ牌1枚を正しく読み取れているか
   - ✅ 推奨打牌が実際に手牌またはツモ牌に含まれているか確認したか（14枚の中から選ぶ）

   **向聴数計算の正確性**:
   - ✅ 手牌の向聴数を実際に計算したか（問題文を鵜呑みにしない）
   - ✅ **手牌構成を数字表記で正確に把握する**:
     - 必ずUnicode → 数字変換を行う
     - 順子を数字で確認（例: 🀔🀕🀖 = 5s6s7s = 567s順子、NOT 456s!）
     - 5枚以上の連続牌は複数の解釈を検討して最良の形を選ぶ
   - ✅ **有効牌と孤立牌を正確に区別する**:
     - **有効牌**: テンパイに直接向かう牌（例: 3m, 3p, 6p）
     - **孤立牌**: 切ることで雀頭形成の可能性が広がる牌（例: 發）
     - ❌ 誤り: "發は有効牌"
     - ✅ 正解: "發は孤立牌で切るべき。發を切ると1m,2m,1p,2p,4p,5pなどで雀頭形成→テンパイ"
   - ✅ **有効牌を全てリストアップし、それぞれでどうなるかテスト**:
     - 例：問題文が「4pを引けばテンパイ」と書いている場合
       1. 実際に4pを加えて14枚にする
       2. 14枚の状態で1枚切ってテンパイになるか確認
       3. 他の牌（2p, 5p, 8pなど）でも同様にテストする
     - 問題文に書かれていない有効牌も発見して解説に含める
   - ✅ 解説で「テンパイ」と書くなら、実際にテンパイか確認したか
   - ✅ 問題文の記述と実際の計算が異なる場合、実際の計算結果を優先したか
   - ✅ 問題文に向聴数の誤りがある場合、解説中で指摘する
   - ✅ **用語を正確に使用する**:
     - ❌ 誤り: "北のポン"（ポンは鳴いた刻子）
     - ✅ 正解: "北の暗刻"（手牌の中の3枚）
     - ❌ 誤り: "567sの一盃口"（一盃口は同じ順子が2組）
     - ✅ 正解: "567sの順子"（単なる順子）
     - 一盃口の例: 234m + 234m（同じ順子が2組）

   **牌の枚数計算の正確性**:
   - ✅ 見えている牌を正確に集計したか（手牌 + 全河 + ドラ表示牌 + 鳴き牌）
   - ✅ 各牌の残り枚数を正しく計算したか（各牌は4枚まで）
   - ✅ 待ち牌の残り枚数を計算したか（河に見えている分を除外）
   - ✅ 受け入れ枚数の計算が正確か（見えている牌を考慮）
   - ✅ アウト牌（危険牌）の枚数計算が正しいか

   **現物（げんぶつ）の識別**:
   - ✅ **押し引き・安全牌選択問題では必須**：リーチがかかっている場合、現物を正確に識別したか
   - ✅ **現物の定義**：リーチ者が既に捨てた牌 = 絶対に当たらない = 100%安全
   - ✅ **識別方法**：リーチ者の河（捨て牌）を確認し、手牌やツモ牌と照合
   - ✅ **記述の正確性**：
     - ❌ 誤り：「対面の河に見えているので比較的安全」
     - ✅ 正解：「対面（リーチ者）の河に見えている現物なので絶対安全（100%安全、0%リスク）」
   - ✅ **複数リーチの場合**：どのリーチ者に対する現物かを明確にする
   - ✅ **重要**：現物があれば必ず「現物 = 絶対安全」と明記し、「比較的安全」などの曖昧な表現は使わない

   **点数計算の正確性**:
   - ✅ 役を正確に認識したか（リーチ、タンヤオ、ピンフなど）
   - ✅ ドラの枚数を正しく数えたか
   - ✅ 翻数と点数の対応が正しいか（1-2翻、3翻、4-5翻満貫、6-7翻跳満など）
   - ✅ 親/子の違いを考慮したか

   **押し引き判断の分析の正確性**（押し引き問題の場合）:
   - ✅ **自分の手の理想形を全て列挙したか**（最低ライン～最良ケースまで）
   - ✅ **和了期待値を定性的に評価したか**（「極めて低い」「低い」「中程度」「高い」）
   - ✅ **相手の河を詳細に分析したか**（ドラの可視性、役牌の可視性、染め手の可能性、リーチタイミング）
   - ✅ **相手の想定手役パターンを複数列挙したか**（7パターン程度、点数範囲付き）
   - ✅ **相手の手の最も可能性の高い点数範囲を結論として明記したか**
   - ✅ **定性的な比較で押し引き判断を示したか**（例：「和了期待値 << 放銃損失」）
   - ❌ **禁止：根拠のない確率数値を使っていないか**（「5-10%」「35%」など）
   - ❌ **禁止：単一点数推測を使っていないか**（「4000点×35%=1400点」など）

   **候補の順序の正確性**:

   **重要**: 押し引き問題では、候補を**戦略別**に分類することを推奨

   **戦略別の分類例**: 14枚 1m2m1p2p3p4p5p5s6s7s北北北發、親番1位、対面リーチ中
   - 候補1: 發を切る - **様子見戦略**（最善）
   - 候補2: 5pを切る - **完全に降りる戦略**（5pは対面の現物）
   - 候補3: 1pを切る - **攻める戦略**（不適切、現物ではなくリスク高い）

   **または、リスク順の分類**:
   - ✅ **候補を必ず良い順（リスクの低い順）に並べたか**
     - 候補1：最善の選択（推奨）
     - 候補2：次善の選択
     - 候補3：最悪の選択
   - ✅ **最悪の候補に明確なラベルを付けたか**（例：「3つの候補の中で最も危険」）
   - ❌ **禁止：候補2が最悪で候補3が次悪という逆順になっていないか**

   **どちらの分類を使うか**:
   - 押し引き問題: 戦略別分類を推奨（様子見の概念を明確にするため）
   - その他の問題: リスク順分類で良い

   **点数配分の妥当性確認**:
   - ✅ 4人の点数合計が100000点になっているか確認
   - ✅ **東1局0本場**の場合：全員が25000点であることを確認
     - 点数に変動があれば問題設定の誤りを指摘
   - ✅ **東1局1本場**の場合：親の点数変動が妥当か確認
     - 親和了 → 親の点数が増えているはず（25000点以上）
     - 親テンパイ流局 → 点数変動は小さい（±1000-3000点程度）
     - 親の点数が大幅減少（例：16000点）は不自然 → 問題設定の誤りを指摘
   - ✅ 問題文の局・本場設定と点数配分が矛盾している場合：
     - 解説中でその矛盾を指摘する
     - ただし、解答自体は問題文の設定を前提として書く

   **ファイル保存の確認**:
   - ✅ ファイルが `problems/NNN/solution.md` 形式で保存されることを確認
   - ✅ 解説が論理的で分かりやすいことを確認

回答を生成した後、ファイルパスを出力してください。

**使用方法**:
- 引数なし: 最新の問題に対する回答を生成（例: `problems/003/solution.md`）
- 引数あり: 指定した番号の問題に対する回答を生成（例: 引数に1を指定 → `problems/001/solution.md`）
